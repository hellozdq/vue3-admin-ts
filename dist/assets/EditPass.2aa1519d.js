import{d as e,n as a,q as o,C as l,r as s,o as r,e as d,j as n,f as t,k as u}from"./vendor.f3ea224c.js";import{J as i}from"./JSEncrypt.a6b5a714.js";import{s as m,c}from"./index.ba8710fc.js";const p=c.get("user");console.log(p);var w=e({setup(e,s){const r=a({id:p.id,account:p.account,password:"",newPassword:"",newPassword2:""}),d={password:[{required:!0,message:"原密码不能为空",trigger:"change"}],newPassword:[{required:!0,message:"新密码不能为空",trigger:"change"}],newPassword2:[{required:!0,message:"请再次输入密码",trigger:"change"},{validator:(e,a,o)=>{a!==r.newPassword?o(new Error("两次输入密码不一致!")):o()},trigger:"blur"}]},n=o(null),t=o(!1);return{form:r,rules:d,save:()=>{n.value.validate((async e=>{if(e){const{id:e}=r,{data:o}=await m({url:"/login/publicKey",method:"get"}),d=new i({});d.setPublicKey(o);const n=d.encrypt(r.password)||"",u=d.encrypt(r.newPassword)||"";t.value=!0,(a={id:e,password:n,newPassword:u},m({url:"/login/updatePassword",method:"put",data:a})).then((()=>{l.success("修改成功！"),s.emit("update:dialogVisible",!1),t.value=!1})).catch((()=>{t.value=!1}))}var a}))},cancel:()=>{s.emit("update:dialogVisible",!1)},formRef:n,loading:t}}});const f=u("保 存"),g=u("取 消");w.render=function(e,a,o,l,u,i){const m=s("el-input"),c=s("el-form-item"),p=s("el-button"),w=s("el-form");return r(),d(w,{ref:"formRef","label-width":"80px",model:e.form,rules:e.rules},{default:n((()=>[t(c,{label:"账号"},{default:n((()=>[t(m,{modelValue:e.form.account,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.account=a),disabled:""},null,8,["modelValue"])])),_:1}),t(c,{label:"原密码",prop:"password"},{default:n((()=>[t(m,{modelValue:e.form.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.password=a),type:"password",placeholder:"请输入原密码"},null,8,["modelValue"])])),_:1}),t(c,{label:"新密码",prop:"newPassword"},{default:n((()=>[t(m,{modelValue:e.form.newPassword,"onUpdate:modelValue":a[3]||(a[3]=a=>e.form.newPassword=a),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"])])),_:1}),t(c,{label:"再次输入",prop:"newPassword2"},{default:n((()=>[t(m,{modelValue:e.form.newPassword2,"onUpdate:modelValue":a[4]||(a[4]=a=>e.form.newPassword2=a),type:"password",placeholder:"请再次输入新密码"},null,8,["modelValue"])])),_:1}),t(c,{label:""},{default:n((()=>[t(p,{size:"medium",type:"primary",onClick:e.save,loading:e.loading},{default:n((()=>[f])),_:1},8,["onClick","loading"]),t(p,{size:"medium",onClick:e.cancel},{default:n((()=>[g])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])};export default w;
